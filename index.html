<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dotazník morálneho správania, odolnosti a emocionálnej stability</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f9fafb;
            color: #1f2937;
            line-height: 1.6;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 28px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 20px;
        }
        
        h2 {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        h3 {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        p {
            margin-bottom: 15px;
            color: #4b5563;
        }
        
        button {
            background-color: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        
        button:hover {
            background-color: #2563eb;
        }
        
        button:disabled {
            background-color: #d1d5db;
            cursor: not-allowed;
        }
        
        button.btn-green {
            background-color: #10b981;
        }
        
        button.btn-green:hover {
            background-color: #059669;
        }
        
        button.btn-gray {
            background-color: #6b7280;
        }
        
        button.btn-gray:hover {
            background-color: #4b5563;
        }
        
        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 16px;
            margin-bottom: 15px;
        }
        
        input[type="checkbox"],
        input[type="radio"] {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }
        
        .question {
            background: white;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
        }
        
        .scale-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .scale-btn {
            min-width: 45px;
            padding: 10px;
            background: white;
            color: #374151;
            border: 1px solid #d1d5db;
        }
        
        .scale-btn.selected {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .nav-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .progress {
            font-size: 14px;
            color: #6b7280;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .info-box {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        
        .warning-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            .card {
                padding: 20px;
            }
            h1 {
                font-size: 22px;
            }
            h2 {
                font-size: 20px;
            }
            button {
                font-size: 14px;
                padding: 10px 18px;
            }
        }
    </style>
</head>
    <script>
        // === GLOBÁLNE PREMENNÉ ===
        let currentScreen = 'intro'; // intro, demographics, questionnaire, results
        let consent = false;
        let demographics = {
            age: '',
            gender: '',
            education: '',
            socialStatus: '',
            relationship: '',
            religious: ''
        };
        let currentSection = 0;
        let responses = {};
        
        // === OTÁZKY ===
        const miqQuestions = [
            { text: "Veľmi sa snažím správať čestne pri väčšine veci, ktoré robím.", reverse: false, id: 1 },
            { text: "Neubližovať ostatným ľuďom je jedno z pravidiel, podľa ktorého sa snažím žiť.", reverse: false, id: 2 },
            { text: "Je pre mňa dôležité správať k ľuďom férovo.", reverse: false, id: 3 },
            { text: "Chcem aby ostatní ľudia vedeli, že sa na mňa môžu spoľahnúť.", reverse: false, id: 4 },
            { text: "Vždy konám spôsobom, ktorý prináša čo najviac dobra a čo najmenej škodí ostatným ľuďom.", reverse: false, id: 5 },
            { text: "Ak robenie niečoho ublíži inej osobe, snažím sa tomu vyhnúť, aj keby o tom nikto nevedel.", reverse: false, id: 6 },
            { text: "Jednou z najdôležitejších vecí v živote je robiť to čo vieš, že je správne.", reverse: false, id: 7 },
            { text: "Keď sa raz rozhodnem o tom, čo je správne urobiť, tak to aj urobím.", reverse: false, id: 8 },
            { text: "Pokiaľ sa rozhodnem spraviť niečo čo mi pomôže, nezáleží na tom, či bude iným ľuďom spôsobená ujma.", reverse: true, id: 9 },
            { text: "Je v poriadku spraviť niečo, o čom vieš, že je nesprávne, ak odmena za to je skvelá.", reverse: true, id: 10 },
            { text: "Ak sa nikto nepozerá alebo o tom nikto nebude vedieť, tak nezáleží na tom či urobím správnu vec.", reverse: true, id: 11 },
            { text: "Je dôležitejšie, ak si ľudia myslia, že som čestný, než byť skutočne čestný.", reverse: true, id: 12 },
            { text: "Ak na to nikto nepríde, tak je v poriadku ukradnúť malú čiastku peňazí či iných vecí, ktoré nebudú nikomu chýbať.", reverse: true, id: 13 },
            { text: "Nemá zmysel vynakladať maximálne úsilie na to, aby som urobil niečo dobré, ak nie je nablízku nikto, kto by to ocenil.", reverse: true, id: 14 },
            { text: "Ak mi pokladník omylom vydá o 10 eur navyše, zvyčajne sa tvárim, akoby som si to nevšimol.", reverse: true, id: 15 },
            { text: "Klamanie a podvádzanie sú veci, ktoré jednoducho musíš v dnešnom svete robiť.", reverse: true, id: 16 },
            { text: "Robiť veci, ktoré niektorí ľudia môžu považovať za nečestné, mi nevadí.", reverse: true, id: 17 },
            { text: "Ak sa ku mne ľudia správajú zle, budem sa k nim správať rovnakým spôsobom.", reverse: true, id: 18 },
            { text: "Súhlasím s rozhodnutím skupiny, aj keď viem, že je to morálne nesprávne.", reverse: true, id: 19 },
            { text: "Mať morálne hodnoty je v dnešnej spoločnosti zbytočné.", reverse: true, id: 20 }
        ];
        
        // Randomizácia MIQ otázok (fixný seed)
        function shuffleArray(array, seed) {
            const arr = [...array];
            let currentSeed = seed;
            for (let i = arr.length - 1; i > 0; i--) {
                currentSeed = (currentSeed * 9301 + 49297) % 233280;
                const j = Math.floor((currentSeed / 233280) * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }
        
        const shuffledMiq = shuffleArray(miqQuestions, 12345);
<body>
    const workerDilemma = "Nedávno jedna spoločnosť prepustila niekoľko zamestnancov z neznámych dôvodov. Niektorí zamestnanci si myslia, že šéfovia odpočúvajú ich súkromné konverzácie cez kamery a mikrofóny v budove a používajú tieto informácie proti nim. Šéfovia však tvrdia, že ich neodpočúvajú. Zamestnanci nemôžu legálne nič urobiť pokiaľ nedokážu, že šéfovia odpočúvajú ich súkromné rozhovory, preto sa dvaja zo zamestnancov vlámu do hlavnej kancelárie a vezmú nahrávky, ktoré dokazujú, že ich šéfovia naozaj odpočúvajú.";
        
        const doctorDilemma = "Jedna žena trpela nevyliečiteľnou chorobou a zomierala. Na konci života mala obrovské bolesti, ktoré už nebolo možné zmierniť žiadnymi liekmi. Nebola pri vedomí, takže bola udržiavaná pri živote iba pomocou prístrojov. Navyše pred stratou vedomia požiadala lekára, aby ukončil jej utrpenie a pomohol jej zomrieť. Z právneho hľadiska by to mohlo byť vnímané ako vražda, lekár sa však rozhodol splniť jej prianie a ženu usmrtil.";
        
        const workerQuestions = [
            { q: "Súhlasili by ste alebo nesúhlasili s konaním pracovníkov?", type: "7point" },
            { q: "Bolo správne vlámať sa, pretože nespôsobili spoločnosti veľké škody.", type: "9point", section: "pro" },
            { q: "Bolo správne vlámať sa, pretože spoločnosť sa neriadila zákonom a konanie zamestnancov umožnilo nastoliť zákon a poriadok.", type: "9point", section: "pro" },
            { q: "Bolo správne vlámať sa, pretože väčšina robotníkov by ich konanie schválila.", type: "9point", section: "pro" },
            { q: "Bolo správne vlámať sa, pretože dôvera medzi ľuďmi a individuálna dôstojnosť sú dôležitejšie ako pravidlá spoločnosti.", type: "9point", section: "pro" },
            { q: "Bolo správne vlámať sa, pretože spoločnosť urobila niečo zlé prvá a dvaja zamestnanci urobili správne.", type: "9point", section: "pro" },
            { q: "Bolo správne vlámať sa, pretože dvaja zamestnanci nevideli žiadny právny spôsob a vybrali si menšie zlo.", type: "9point", section: "pro" },
            { q: "Bolo nesprávne vlámať sa, pretože ak by každý konal tak, išli by sme proti zákonu a poriadku.", type: "9point", section: "con" },
            { q: "Bolo nesprávne vlámať sa, pretože človek nesmie porušovať základné právo na ochranu majetku.", type: "9point", section: "con" },
            { q: "Bolo nesprávne vlámať sa, pretože riskovať prepustenie len aby ste pomohli iným nie je rozumné.", type: "9point", section: "con" },
            { q: "Bolo nesprávne vlámať sa, pretože mali využiť všetky dostupné legálne cesty.", type: "9point", section: "con" },
            { q: "Bolo nesprávne vlámať sa, pretože človek nekradne, ak chce byť považovaný za slušného.", type: "9point", section: "con" },
            { q: "Bolo nesprávne vlámať sa, pretože prepustenie iných s nimi nemalo nič spoločné.", type: "9point", section: "con" }
        ];
        
        const doctorQuestions = [
            { q: "Súhlasili by ste alebo nesúhlasili s konaním lekára?", type: "7point" },
            { q: "Lekár sa zachoval správne, pretože musel konať podľa svojho svedomia. Bolesť ženy oprávňovala ignorovať povinnosť zachovať život.", type: "9point", section: "pro" },
            { q: "Lekár sa zachoval správne, pretože bol jediný kto mohol spraviť to, o čo ho žena požiadala.", type: "9point", section: "pro" },
            { q: "Lekár sa zachoval správne, pretože urobil iba to, k čomu ho žena presvedčila.", type: "9point", section: "pro" },
            { q: "Lekár sa zachoval správne, pretože žena by tak či tak umrela.", type: "9point", section: "pro" },
            { q: "Lekár sa zachoval správne, pretože v skutočnosti neporušil zákon a chcel len skrátiť utrpenie.", type: "9point", section: "pro" },
            { q: "Lekár sa zachoval správne, pretože väčšina jeho kolegov by sa zachovali rovnako.", type: "9point", section: "pro" },
            { q: "Lekár sa zachoval nesprávne, pretože konal v rozpore s presvedčením ostatných lekárov.", type: "9point", section: "con" },
            { q: "Lekár sa zachoval nesprávne, pretože človek by mal mať úplnú vieru v lekárov záväzok zachrániť každý život.", type: "9point", section: "con" },
            { q: "Lekár sa zachoval nesprávne, pretože ochrana života je najvyššou morálnou povinnosťou.", type: "9point", section: "con" },
            { q: "Lekár sa zachoval nesprávne, pretože sa mohol dostať do veľkých problémov.", type: "9point", section: "con" },
            { q: "Lekár sa zachoval nesprávne, pretože to mohol mať jednoduchšie, keby počkal.", type: "9point", section: "con" },
            { q: "Lekár sa zachoval nesprávne, pretože porušil zákon.", type: "9point", section: "con" }
        ];
        const cdRiscQuestions = [
            "Viem sa prispôsobiť, keď sa objavia zmeny.",
            "Viem sa vysporiadať s čímkoľvek čo mi príde do cesty.",
            "Snažím sa vidieť vtipnú stránku vecí, keď čelím problémom.",
            "Vyrovnávanie sa so stresom ma môže posilniť.",
            "Mám tendenciu dať sa dokopy po zranení, chorobe či iných ťažkostiach.",
            "Verím, že dokážem dosiahnuť svoje ciele, aj keď mi v ceste stoja prekážky.",
            "Pod tlakom ostávam sústredený a premýšľam jasne.",
            "Nedám sa ľahko odradiť neúspechom.",
            "Považujem sa za silného človeka, keď čelím životným výzvam a ťažkostiam.",
            "Som schopný zvládať nepríjemné alebo bolestivé pocity ako smútok, strach a hnev.",
            "Ďakujeme, že odpovedáte pozorne. Toto je kontrolná položka. Zvoľte, prosím možnosť 1."
        ];
        
        const bfiQuestions = [
            "sa veľa znepokojuje.",
            "má sklon cítiť sa skľúčený, skleslý.",
            "je emocionálne stabilný, neznepokojí sa tak ľahko.",
            "je uvoľnený, dobre zvláda stres.",
            "sa cíti sebaistý, je spokojný so sebou.",
            "je temperamentný, ľahko sa rozčúli."
        ];
        
        // Sekcie dotazníka
        const sections = [
            {
                name: "Morálna identita",
                instruction: "V tejto časti bude Vašou úlohou vyjadriť Váš súhlas či nesúhlas s nasledujúcimi výrokmi.",
                questions: shuffledMiq,
                scale: "6point"
            },
            {
                name: "Morálne uvažovanie - Robotníci",
                instruction: "Vašou úlohou v častiach 2 a 3 bude prečítať si dilemu a vyjadriť Váš súhlas či nesúhlas s konaním postáv v dileme, a tiež vyjadriť Váš súhlas či nesúhlas s argumentami uvedenými nižšie.",
                questions: workerQuestions,
                dilemma: workerDilemma
            },
            {
                name: "Morálne uvažovanie - Lekár",
                instruction: "Vašou úlohou v častiach 2 a 3 bude prečítať si dilemu a vyjadriť Váš súhlas či nesúhlas s konaním postáv v dileme, a tiež vyjadriť Váš súhlas či nesúhlas s argumentami uvedenými nižšie.",
                questions: doctorQuestions,
                dilemma: doctorDilemma
            },
            {
                name: "Resilencia",
                instruction: "V tejto časti bude Vašou úlohou vyjadriť Váš súhlas či nesúhlas s nasledujúcimi výrokmi.",
                questions: cdRiscQuestions,
                scale: "5point-cdrisc"
            },
            {
                name: "Emocionálna stabilita",
                instruction: "V tejto časti bude Vašou úlohou vyjadriť Váš súhlas či nesúhlas s nasledujúcimi výrokmi.",
                questions: bfiQuestions,
                scale: "5point-bfi"
            }
        ];
        // === VÝPOČTOVÉ FUNKCIE ===
        function calculateResults() {
            const results = {};
            
            // Morálna motivácia (MM) - otázky 1-8 (nie reverse)
            let mmSum = 0, mmCount = 0;
            shuffledMiq.forEach((q, idx) => {
                const val = responses[`0-${idx}`];
                if (val !== undefined && !q.reverse && q.id <= 8) {
                    mmSum += val;
                    mmCount++;
                }
            });
            results.moralSelf = mmCount > 0 ? (mmSum / mmCount).toFixed(2) : 0;
            
            // Morálne konanie (MK) - reverzné otázky
            let mkSum = 0, mkCount = 0;
            shuffledMiq.forEach((q, idx) => {
                const val = responses[`0-${idx}`];
                if (val !== undefined && q.reverse) {
                    mkSum += (7 - val);
                    mkCount++;
                }
            });
            results.moralIntegrity = mkCount > 0 ? (mkSum / mkCount).toFixed(2) : 0;
            
            // MJT C-skóre
            const workerResps = [];
            const doctorResps = [];
            for (let i = 1; i < 13; i++) {
                if (responses[`1-${i}`]) workerResps.push(responses[`1-${i}`]);
                if (responses[`2-${i}`]) doctorResps.push(responses[`2-${i}`]);
            }
            
            function calcCScore(arr) {
                if (arr.length < 6) return 0;
                const mean = arr.reduce((a, b) => a + b, 0) / arr.length;
                const variance = arr.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / arr.length;
                return Math.min(100, Math.max(0, 100 - (variance * 10)));
            }
            
            const workerC = calcCScore(workerResps);
            const doctorC = calcCScore(doctorResps);
            results.mjtCScore = ((workerC + doctorC) / 2).toFixed(1);
            
            // CD-RISC Odolnosť
            let resSum = 0;
            for (let i = 0; i < 10; i++) {
                if (responses[`3-${i}`]) resSum += responses[`3-${i}`];
            }
            results.resilience = resSum;
            
            // BFI Negatívna emocionalita
            const revItems = [2, 3, 4];
            let neSum = 0, neCount = 0;
            for (let i = 0; i < 6; i++) {
                const val = responses[`4-${i}`];
                if (val !== undefined) {
                    neSum += revItems.includes(i) ? (6 - val) : val;
                    neCount++;
                }
            }
            results.negativeEmotionality = neCount > 0 ? (neSum / neCount).toFixed(2) : 0;
            
            return results;
        }
        
        // Uloženie dát do Google Sheets
        async function saveToGoogleSheets() {
            const SHEETS_URL = 'https://script.google.com/macros/s/AKfycbwUBwarAiGFt-SeZevH75YEbIK0_r7VyZTI4ZW-96wIXKOjubfZLyzctS349a0N7_xw8w/exec';
            
            try {
                const results = calculateResults();
                const timestamp = new Date().toISOString();
                
                const existingData = localStorage.getItem('questionnaire_data');
                const respondentCount = existingData ? JSON.parse(existingData).length + 1 : 1;
                const respondentId = `R${String(respondentCount).padStart(3, '0')}`;
                
                const miqResponses = [];
                for (let i = 0; i < 20; i++) {
                    miqResponses.push(responses[`0-${i}`] || '');
                }
                
                const mjtRobotnici = [];
                for (let i = 0; i < 13; i++) {
                    mjtRobotnici.push(responses[`1-${i}`] || '');
                }
                
                const mjtLekar = [];
                for (let i = 0; i < 13; i++) {
                    mjtLekar.push(responses[`2-${i}`] || '');
                }
                
                const cdRiscResponses = [];
                for (let i = 0; i < 11; i++) {
                    cdRiscResponses.push(responses[`3-${i}`] || '');
                }
                
                const bfiResponses = [];
                for (let i = 0; i < 6; i++) {
                    bfiResponses.push(responses[`4-${i}`] || '');
                }
                
                const payload = {
                    id: respondentId,
                    timestamp: timestamp,
                    demographics: demographics,
                    responses: {
                        miq: miqResponses,
                        mjt: {
                            robotnici: mjtRobotnici,
                            lekar: mjtLekar
                        },
                        cdrisc: cdRiscResponses,
                        bfi: bfiResponses
                    },
                    results: results
                };
                
                await fetch(SHEETS_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                console.log('✅ Dáta uložené do Google Sheets');
            } catch (error) {
                console.error('Chyba:', error);
            }
        }
        // === RENDEROVANIE ===
        function render() {
            const app = document.getElementById('app');
            
            if (currentScreen === 'intro') {
                app.innerHTML = `
                    <div class="container">
                        <div class="card">
                            <h1>Dotazník morálneho správania, odolnosti a emocionálnej stability</h1>
                            
                            <p><strong>Dobrý deň,</strong></p>
                            <p>Som Claudia Bártová, študentka Psychológie na Univerzite Komenského v Bratislave a obraciam sa na Vás s prosbou o účasť na výskume, ktorý sa uskutočňuje v rámci mojej diplomovej práce.</p>
                            
                            <div class="info-box">
                                <p><strong>Cieľom tejto štúdie</strong> je preskúmať vzťahy medzi morálnym uvažovaním, morálnou identitou, rezilienciou a emocionálnou stabilitou.</p>
                            </div>
                            
                            <p>Dotazník pozostáva z <strong>viacerých častí</strong>, ktoré Vám zabavia približne <strong>10-15 minút</strong>. Na konci dotazníka uvidíte <strong>Vaše výsledky</strong> s osobným vyhodnotením.</p>
                            
                            <p>Všetky <strong>vaše odpovede sú anonymné</strong> a ukončenie vypĺňania dotazníka je možné kedykoľvek. Odpovedajte prosím pravdivo, žiadna z odpovedí nie je nesprávna.</p>
                            
                            <p>V prípade akýchkoľvek otázok ma môžete kontaktovať na e-mailovej adrese <a href="mailto:claudiabartova@gmail.com" style="color: #3b82f6;">claudiabartova@gmail.com</a>.</p>
                            
                            <p><strong>Ďakujem za zapojenie sa do výskumu a pomoc pri mojej diplomovej práci.</strong></p>
                            
                            <div style="background: #eff6ff; border: 2px solid #3b82f6; border-radius: 8px; padding: 20px; margin: 20px 0;">
                                <label style="display: flex; align-items: start; cursor: pointer;">
                                    <input type="checkbox" id="consentCheck" ${consent ? 'checked' : ''} 
                                           onchange="consent = this.checked; render();" 
                                           style="margin-top: 4px;">
                                    <span style="margin-left: 10px; font-weight: 600;">
                                        Súhlasím s anonymným spracovaním dát dotazníka pre účely výskumu.
                                    </span>
                                </label>
                            </div>
                            
                            <button onclick="if(consent) { currentScreen = 'demographics'; render(); }" 
                                    ${!consent ? 'disabled' : ''}>
                                ${consent ? 'Pokračovať' : 'Prosím, potvrďte súhlas'}
                            </button>
                        </div>
                    </div>
                `;
                return;
            }
       if (currentScreen === 'demographics') {
                app.innerHTML = `
                    <div class="container">
                        <div class="card">
                            <h2>Demografické údaje</h2>
                            <p>Prosím, vyplňte nasledujúce údaje:</p>
                            
                            <div style="margin-bottom: 20px;">
                                <label><strong>1. Aký je Váš vek? (uvádzajte číslom)</strong></label>
                                <input type="number" id="age" value="${demographics.age}" 
                                       oninput="demographics.age = this.value; render();">
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label><strong>2. Aké je Vaše pohlavie?</strong></label>
                                <select id="gender" onchange="demographics.gender = this.value; render();">
                                    <option value="">-- Vyberte --</option>
                                    <option value="Muž" ${demographics.gender === 'Muž' ? 'selected' : ''}>Muž</option>
                                    <option value="Žena" ${demographics.gender === 'Žena' ? 'selected' : ''}>Žena</option>
                                    <option value="Iné" ${demographics.gender === 'Iné' ? 'selected' : ''}>Iné</option>
                                </select>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label><strong>3. Aké je Vaše najvyššie dosiahnuté vzdelanie?</strong></label>
                                <select id="education" onchange="demographics.education = this.value; render();">
                                    <option value="">-- Vyberte --</option>
                                    <option value="Základné" ${demographics.education === 'Základné' ? 'selected' : ''}>Základné</option>
                                    <option value="Stredoškolské" ${demographics.education === 'Stredoškolské' ? 'selected' : ''}>Stredoškolské</option>
                                    <option value="Vysokoškolské (Bc.)" ${demographics.education === 'Vysokoškolské (Bc.)' ? 'selected' : ''}>Vysokoškolské (Bc.)</option>
                                    <option value="Vysokoškolské (Mgr./Ing.)" ${demographics.education === 'Vysokoškolské (Mgr./Ing.)' ? 'selected' : ''}>Vysokoškolské (Mgr./Ing.)</option>
                                    <option value="Doktorandské (PhD.)" ${demographics.education === 'Doktorandské (PhD.)' ? 'selected' : ''}>Doktorandské (PhD.)</option>
                                </select>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label><strong>4. Aký je Váš sociálny status?</strong></label>
                                <select id="socialStatus" onchange="demographics.socialStatus = this.value; render();">
                                    <option value="">-- Vyberte --</option>
                                    <option value="Študent/ka" ${demographics.socialStatus === 'Študent/ka' ? 'selected' : ''}>Študent/ka</option>
                                    <option value="Zamestnaný/á" ${demographics.socialStatus === 'Zamestnaný/á' ? 'selected' : ''}>Zamestnaný/á</option>
                                    <option value="Nezamestnaný/á" ${demographics.socialStatus === 'Nezamestnaný/á' ? 'selected' : ''}>Nezamestnaný/á</option>
                                    <option value="Na materskej/rodičovskej dovolenke" ${demographics.socialStatus === 'Na materskej/rodičovskej dovolenke' ? 'selected' : ''}>Na materskej/rodičovskej dovolenke</option>
                                </select>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label><strong>5. Aký je Váš partnerský stav?</strong></label>
                                <select id="relationship" onchange="demographics.relationship = this.value; render();">
                                    <option value="">-- Vyberte --</option>
                                    <option value="Zadaný/á" ${demographics.relationship === 'Zadaný/á' ? 'selected' : ''}>Zadaný/á</option>
                                    <option value="Slobodný/á" ${demographics.relationship === 'Slobodný/á' ? 'selected' : ''}>Slobodný/á</option>
                                </select>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label><strong>6. Považujete sa za veriaceho?</strong></label>
                                <select id="religious" onchange="demographics.religious = this.value; render();">
                                    <option value="">-- Vyberte --</option>
                                    <option value="Áno" ${demographics.religious === 'Áno' ? 'selected' : ''}>Áno</option>
                                    <option value="Nie" ${demographics.religious === 'Nie' ? 'selected' : ''}>Nie</option>
                                </select>
                            </div>
                            
                            <button onclick="
                                if (demographics.age && demographics.gender && demographics.education && 
                                    demographics.socialStatus && demographics.relationship && demographics.religious) {
                                    currentScreen = 'questionnaire';
                                    render();
                                } else {
                                    alert('Prosím vyplňte všetky polia');
                                }
                            ">
                                Pokračovať
                            </button>
                        </div>
                    </div>
                `;
                return;
            }   
           if (currentScreen === 'questionnaire') {
                const section = sections[currentSection];
                const allAnswered = section.questions.every((_, idx) => 
                    responses[`${currentSection}-${idx}`] !== undefined
                );
                
                let questionsHTML = '';
                
                section.questions.forEach((q, idx) => {
                    const questionText = typeof q === 'string' ? q : (q.text || q.q);
                    const questionType = q.type || section.scale;
                    
                    // Sekčné hlavičky pre MJT
                    let sectionHeader = '';
                    if (currentSection === 1 && idx === 1) {
                        sectionHeader = '<div class="info-box" style="background: #dbeafe;"><p><strong>Nakoľko prijateľné sú pre vás nasledujúce argumenty v prospech konania dvoch pracovníkov?</strong></p></div>';
                    } else if (currentSection === 1 && idx === 7) {
                        sectionHeader = '<div class="warning-box"><p><strong>Nakoľko prijateľné sú pre vás nasledujúce argumenty v neprospech konania dvoch pracovníkov?</strong></p></div>';
                    } else if (currentSection === 2 && idx === 1) {
                        sectionHeader = '<div class="info-box" style="background: #dbeafe;"><p><strong>Nakoľko prijateľné sú pre vás nasledujúce argumenty v prospech konania lekára?</strong></p></div>';
                    } else if (currentSection === 2 && idx === 7) {
                        sectionHeader = '<div class="warning-box"><p><strong>Nakoľko prijateľné sú pre vás nasledujúce argumenty v neprospech konania lekára?</strong></p></div>';
                    }
                    
                    questionsHTML += sectionHeader;
                    questionsHTML += `<div class="question">`;
                    
                    if (currentSection === 4) {
                        questionsHTML += `<p><strong>Osoba, ktorú poznám...</strong> ${questionText}</p>`;
                    } else {
                        questionsHTML += `<p><strong>${idx + 1}. ${questionText}</strong></p>`;
                    }
                    
                    // Renderovanie škál
                    if (questionType === '6point') {
                        const labels = ["Úplne nesúhlasím", "Nesúhlasím", "Skôr nesúhlasím", "Skôr súhlasím", "Súhlasím", "Úplne súhlasím"];
                        questionsHTML += '<div class="scale-buttons">';
                        for (let i = 1; i <= 6; i++) {
                            const selected = responses[`${currentSection}-${idx}`] === i ? 'selected' : '';
                            questionsHTML += `
                                <button class="scale-btn ${selected}" 
                                        onclick="responses['${currentSection}-${idx}'] = ${i}; render();">
                                    ${i}<br><small>${labels[i-1]}</small>
                                </button>
                            `;
                        }
                        questionsHTML += '</div>';
                    } else if (questionType === '7point') {
                        const labels = ["Vôbec nesúhlasím", "Nesúhlasím", "Skôr nesúhlasím", "Neutrálne", "Skôr súhlasím", "Súhlasím", "Úplne súhlasím"];
                        questionsHTML += '<div class="scale-buttons">';
                        for (let i = 1; i <= 7; i++) {
                            const selected = responses[`${currentSection}-${idx}`] === i ? 'selected' : '';
                            questionsHTML += `
                                <button class="scale-btn ${selected}" 
                                        onclick="responses['${currentSection}-${idx}'] = ${i}; render();">
                                    ${i}<br><small>${labels[i-1]}</small>
                                </button>
                            `;
                        }
                        questionsHTML += '</div>';
                    } else if (questionType === '9point') {
                        questionsHTML += '<div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">';
                        questionsHTML += '<span style="font-size: 12px; color: #6b7280;">Vôbec nesúhlasím</span>';
                        questionsHTML += '<div class="scale-buttons" style="flex: 1;">';
                        for (let i = -4; i <= 4; i++) {
                            const selected = responses[`${currentSection}-${idx}`] === i ? 'selected' : '';
                            questionsHTML += `
                                <button class="scale-btn ${selected}" 
                                        onclick="responses['${currentSection}-${idx}'] = ${i}; render();">
                                    ${i}
                                </button>
                            `;
                        }
                        questionsHTML += '</div>';
                        questionsHTML += '<span style="font-size: 12px; color: #6b7280;">Úplne súhlasím</span>';
                        questionsHTML += '</div>';
                    } else if (questionType === '5point-cdrisc') {
                        const labels = ["Vôbec nie pravda", "Zriedka pravda", "Niekedy pravda", "Často pravda", "Takmer vždy pravda"];
                        questionsHTML += '<div class="scale-buttons">';
                        for (let i = 1; i <= 5; i++) {
                            const selected = responses[`${currentSection}-${idx}`] === i ? 'selected' : '';
                            questionsHTML += `
                                <button class="scale-btn ${selected}" 
                                        onclick="responses['${currentSection}-${idx}'] = ${i}; render();">
                                    ${i}<br><small>${labels[i-1]}</small>
                                </button>
                            `;
                        }
                        questionsHTML += '</div>';
                    } else if (questionType === '5point-bfi') {
                        const labels = ["Úplne nesúhlasím", "Skôr nesúhlasím", "Neutrálne", "Skôr súhlasím", "Úplne súhlasím"];
                        questionsHTML += '<div class="scale-buttons">';
                        for (let i = 1; i <= 5; i++) {
                            const selected = responses[`${currentSection}-${idx}`] === i ? 'selected' : '';
                            questionsHTML += `
                                <button class="scale-btn ${selected}" 
                                        onclick="responses['${currentSection}-${idx}'] = ${i}; render();">
                                    ${i}<br><small>${labels[i-1]}</small>
                                </button>
                            `;
                        }
                        questionsHTML += '</div>';
                    }
                    
                    questionsHTML += '</div>';
                });
                
                app.innerHTML = `
                    <div class="container">
                        <div class="card">
                            <h2>${section.name}</h2>
                            <p class="progress">Sekcia ${currentSection + 1} z ${sections.length}</p>
                            <div class="info-box">
                                <p>${section.instruction}</p>
                            </div>
                            ${section.dilemma ? `<div class="warning-box"><p><strong>Dilema:</strong> ${section.dilemma}</p></div>` : ''}
                            ${questionsHTML}
                            <div class="nav-buttons">
                                ${currentSection > 0 ? `
                                    <button class="btn-gray" onclick="currentSection--; render();">
                                        ← Späť
                                    </button>
                                ` : ''}
                                ${currentSection < sections.length - 1 ? `
                                    <button ${!allAnswered ? 'disabled' : ''} 
                                            onclick="if(${allAnswered}) { currentSection++; render(); }"
                                            style="margin-left: auto;">
                                        Ďalej →
                                    </button>
                                ` : `
                                    <button class="btn-green" ${!allAnswered ? 'disabled' : ''} 
                                            onclick="if(${allAnswered}) { currentScreen = 'results'; saveToGoogleSheets(); localStorage.setItem('questionnaire_data', JSON.stringify([...JSON.parse(localStorage.getItem('questionnaire_data') || '[]'), {timestamp: new Date().toISOString(), demographics, responses, results: calculateResults()}])); render(); }"
                                            style="margin-left: auto;">
                                        Zobraziť výsledky
                                    </button>
                                `}
                            </div>
                            <p style="text-align: center; margin-top: 15px; font-size: 14px; color: ${allAnswered ? '#10b981' : '#6b7280'};">
                                ${allAnswered ? '✓ Všetky otázky zodpovedané' : 'Prosím zodpovedajte všetky otázky pred pokračovaním'}
                            </p>
                        </div>
                    </div>
                `;
                return;
            }
               if (currentScreen === 'results') {
                const results = calculateResults();
                
                app.innerHTML = `
                    <div class="container">
                        <div class="card" style="background: linear-gradient(to right, #10b981, #14b8a6); color: white;">
                            <h1>✓ Vaše výsledky</h1>
                            <p>Ďakujeme za vyplnenie dotazníka! Vaše odpovede boli automaticky uložené.</p>
                        </div>
                        
                        <div class="card">
                            <h3 style="color: #10b981;">1. Morálne uvažovanie (MJT)</h3>
                            <div class="info-box">
                                <p><strong>Morálne uvažovanie</strong> je schopnosť posúdiť, ktorý čin je morálne správny či nesprávny.</p>
                            </div>
                            <p><strong>C-skóre:</strong> ${results.mjtCScore} / 100</p>
                            <div style="background: ${results.mjtCScore < 20 ? '#ef4444' : results.mjtCScore < 30 ? '#f97316' : results.mjtCScore < 40 ? '#eab308' : '#22c55e'}; color: white; padding: 15px; border-radius: 6px; margin-top: 10px;">
                                <strong>Úroveň: ${results.mjtCScore < 20 ? 'Nízka' : results.mjtCScore < 30 ? 'Stredná' : results.mjtCScore < 40 ? 'Vysoká' : 'Veľmi vysoká'}</strong>
                            </div>
                        </div>
                        
                        <div class="card">
                            <h3 style="color: #3b82f6;">2. Morálna motivácia</h3>
                            <div class="info-box">
                                <p><strong>Morálna motivácia</strong> je odhodlanie konať na základe toho čo je podľa morálneho uvažovania správne, teda uprednostňovať morálnu hodnotu pred všetkými ostatnými.</p>
                            </div>
                            <p><strong>Skóre:</strong> ${results.moralSelf} / 6</p>
                            <div style="background: ${results.moralSelf < 3 ? '#ef4444' : results.moralSelf < 4 ? '#eab308' : '#22c55e'}; color: white; padding: 15px; border-radius: 6px; margin-top: 10px;">
                                <strong>Úroveň: ${results.moralSelf < 3 ? 'Nízka' : results.moralSelf < 4 ? 'Priemerná' : 'Vysoká'}</strong>
                            </div>
                        </div>
                        
                        <div class="card">
                            <h3 style="color: #8b5cf6;">3. Morálne konanie</h3>
                            <div class="info-box">
                                <p><strong>Morálne konanie</strong> je skutočná implementácia morálnych činov.</p>
                            </div>
                            <p><strong>Skóre:</strong> ${results.moralIntegrity} / 6</p>
                            <div style="background: ${results.moralIntegrity < 3 ? '#ef4444' : results.moralIntegrity < 4 ? '#eab308' : '#22c55e'}; color: white; padding: 15px; border-radius: 6px; margin-top: 10px;">
                                <strong>Úroveň: ${results.moralIntegrity < 3 ? 'Nízka' : results.moralIntegrity < 4 ? 'Priemerná' : 'Vysoká'}</strong>
                            </div>
                        </div>
                        
                        <div class="card">
                            <h3 style="color: #f97316;">4. Odolnosť (CD-RISC-10)</h3>
                            <div class="info-box">
                                <p><strong>Odolnosť</strong> je schopnosť vyrovnať sa s nepriaznivými životnými udalosťami.</p>
                            </div>
                            <p><strong>Skóre:</strong> ${results.resilience} / 40</p>
                            <div style="background: ${results.resilience < 25 ? '#ef4444' : results.resilience < 32 ? '#eab308' : '#22c55e'}; color: white; padding: 15px; border-radius: 6px; margin-top: 10px;">
                                <strong>Úroveň: ${results.resilience < 25 ? 'Nízka' : results.resilience < 32 ? 'Priemerná' : 'Vysoká'}</strong>
                            </div>
                        </div>
                        
                        <div class="card">
                            <h3 style="color: #14b8a6;">5. Emocionálna stabilita (BFI-2)</h3>
                            <div class="info-box">
                                <p><strong>Emocionálna stabilita</strong> je tendencia zažívať negatívne emócie.</p>
                            </div>
                            <p><strong>Skóre (invertované):</strong> ${(5 - results.negativeEmotionality).toFixed(2)} / 5</p>
                            <div style="background: ${results.negativeEmotionality > 3.59 ? '#ef4444' : results.negativeEmotionality > 2.15 ? '#eab308' : '#22c55e'}; color: white; padding: 15px; border-radius: 6px; margin-top: 10px;">
                                <strong>Úroveň: ${results.negativeEmotionality > 3.59 ? 'Nízka' : results.negativeEmotionality > 2.15 ? 'Priemerná' : 'Vysoká'}</strong>
                            </div>
                        </div>
                        
                        <div class="card" style="background: #f3f4f6;">
                            <p style="text-align: center; color: #6b7280;">
                                Ďakujeme za Vašu účasť vo výskume!<br>
                                Vaše odpovede boli úspešne odoslané.
                            </p>
                        </div>
                    </div>
                `;
                return;
            }
        }
        // === INICIALIZÁCIA ===
        
        // Spusť aplikáciu po načítaní stránky
        document.addEventListener('DOMContentLoaded', function() {
            render();
        });
        
        // Prvé vykreslenie
        render();
    </script>
</body>
</html>
    <div id="app"></div>
